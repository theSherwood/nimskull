<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>compiler/sem/sem</title>
<link rel="stylesheet" type="text/css" href="../nimdoc.out.css">

<script type="text/javascript" src="../dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  if (toggleSwitch !== null) {
    toggleSwitch.addEventListener('change', switchTheme, false);
  }

  var currentTheme = localStorage.getItem('theme');
  if (!currentTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    currentTheme = 'dark';
  }
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark' && toggleSwitch !== null) {
      toggleSwitch.checked = true;
    }
  }
}

window.addEventListener('DOMContentLoaded', main);
</script>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">compiler/sem/sem</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple-boot">
      <li><a href="manual.html">Manual</a></li>
      <li><a href="style_guide.html">Style guide</a></li>
      <li><a href="contributing.html">Contribution guide</a></li>
      <li><a href="lib.html">Standard library</a></li>
      <li><a href="../theindex.html">Index</a></li>
      <li><a href="compiler/../theindex.html">Compiler docs</a></li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="template-basics_toc" href="#template-basics">Template Basics</a></li>
<li><a class="reference" id="template-taxonomy_toc" href="#template-taxonomy">Template Taxonomy</a></li>
<ul class="simple"><li><a class="reference" id="template-taxonomy-substitution-positions_toc" href="#template-taxonomy-substitution-positions">Substitution Positions</a></li>
</ul><li><a class="reference" id="future-considerationsslashimprovementscolon_toc" href="#future-considerationsslashimprovementscolon">Future Considerations/Improvements:</a></li>
<li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#10" id="60">Consts</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#semPass"
    title="semPass = (open: myOpen, process: myProcess, close: myClose, isFrontend: true)">semPass</a></li>
  <li><a class="reference" href="#tyGenericLike"
    title="tyGenericLike = {tyGenericInvocation, tyGenericInst, tyArray, tySet, tySequence,
                 tyOpenArray, tyUserTypeClassInst..tyCompositeTypeClass}">tyGenericLike</a></li>
  <li><a class="reference" href="#tyMagicGenerics"
    title="tyMagicGenerics = {tySet, tySequence, tyArray, tyOpenArray}">tyMagicGenerics</a></li>
  <li><a class="reference" href="#tyUserDefinedGenerics"
    title="tyUserDefinedGenerics = {tyGenericInst, tyGenericInvocation, tyUserTypeClassInst}">tyUserDefinedGenerics</a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">commonType
      <li><a class="reference" href="#commonType%2CPContext%2CPType%2CPType"
    title="commonType(c: PContext; x, y: PType): PType">commonType(c: PContext; x, y: PType): PType</a></li>
  <li><a class="reference" href="#commonType%2CPContext%2CPType%2CPNode"
    title="commonType(c: PContext; x: PType; y: PNode): PType">commonType(c: PContext; x: PType; y: PNode): PType</a></li>

  </ul>
  <ul class="simple nested-toc-section">defNameErrorNodeAllowsSymUpdate
      <li><a class="reference" href="#defNameErrorNodeAllowsSymUpdate%2CPNode"
    title="defNameErrorNodeAllowsSymUpdate(n: PNode): bool">defNameErrorNodeAllowsSymUpdate(n: PNode): bool</a></li>

  </ul>
  <ul class="simple nested-toc-section">getDefNameSymOrRecover
      <li><a class="reference" href="#getDefNameSymOrRecover%2CPNode"
    title="getDefNameSymOrRecover(n: PNode): PSym">getDefNameSymOrRecover(n: PNode): PSym</a></li>

  </ul>
  <ul class="simple nested-toc-section">instGenericConvertersArg
      <li><a class="reference" href="#instGenericConvertersArg%2CPContext%2CPNode%2CTCandidate"
    title="instGenericConvertersArg(c: PContext; a: PNode; x: TCandidate)">instGenericConvertersArg(c: PContext; a: PNode; x: TCandidate)</a></li>

  </ul>
  <ul class="simple nested-toc-section">instGenericConvertersSons
      <li><a class="reference" href="#instGenericConvertersSons%2CPContext%2CPNode%2CTCandidate"
    title="instGenericConvertersSons(c: PContext; n: PNode; x: TCandidate)">instGenericConvertersSons(c: PContext; n: PNode; x: TCandidate)</a></li>

  </ul>
  <ul class="simple nested-toc-section">maybeResemArgs
      <li><a class="reference" href="#maybeResemArgs%2CPContext%2CPNode%2Cint"
    title="maybeResemArgs(c: PContext; n: PNode; startIdx: int = 1): seq[PNode]">maybeResemArgs(c: PContext; n: PNode; startIdx: int = 1): seq[PNode]</a></li>

  </ul>
  <ul class="simple nested-toc-section">newSymGNode
      <li><a class="reference" href="#newSymGNode%2CTSymKind%2CPNode%2CPContext"
    title="newSymGNode(kind: TSymKind; n: PNode; c: PContext): PNode">newSymGNode(kind: TSymKind; n: PNode; c: PContext): PNode</a></li>

  </ul>
  <ul class="simple nested-toc-section">toLiterals
      <li><a class="reference" href="#toLiterals%2CIntSet%2CPType"
    title="toLiterals(vals: IntSet; t: PType): seq[PNode]">toLiterals(vals: IntSet; t: PType): seq[PNode]</a></li>

  </ul>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#18" id="68">Templates</a>
  <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">commonTypeBegin
      <li><a class="reference" href="#commonTypeBegin.t"
    title="commonTypeBegin(): PType">commonTypeBegin(): PType</a></li>

  </ul>

  </ul>
</li>

</ul>

  </div>
  &nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L1"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L1" class="link-seesrc" target="_blank" >Edit</a>

  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc">This module implements the instantiation of generic procs. included from sem.nimThis module implements semantic checking for calls. included from sem.nimthis module does the semantic checking of type declarations included from sem.nimThe current implementation of templates might not yet conform to the description that follows.
<h1><a class="toc-backref" id="template-basics" href="#template-basics">Template Basics</a></h1><p>Given a basic template as follows: ..code:<pre>template identity(arg: untyped): untyped =
  arg</pre>
</p>
<p>The template's output type is <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt>, meaning the body (<tt class="docutils literal"><span class="pre"><span class="Identifier">arg</span></span></tt>) is treated as an <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> AST fragment, that substitution of parameters will evaluate per the rules of <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> templates, and finally evaluation and insertion of the template at the callsite will be hygeinic. The template parameter <tt class="docutils literal"><span class="pre"><span class="Identifier">arg</span></span></tt> will be captured as <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt>, meaning no attempt will be made to semantically analyse the parameter prior to substitution.</p>

<h1><a class="toc-backref" id="template-taxonomy" href="#template-taxonomy">Template Taxonomy</a></h1><p>There are at least four types of templates across two categories:</p>
<ul class="simple"><li>AST templates:<ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt><ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">dirty</span></span></tt> a non-hygienic sub-variant</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">typed</span></span></tt></li>
</ul>
</li>
<li>expression templates (all types that are not <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> or <tt class="docutils literal"><span class="pre"><span class="Identifier">typed</span></span></tt>)</li>
</ul>

<h2><a class="toc-backref" id="template-taxonomy-substitution-positions" href="#template-taxonomy-substitution-positions">Substitution Positions</a></h2><p>Templates are ultimately AST level constructs regardless of output type, even they follow the grammar. There are two types of positions in a template body, one is <tt class="docutils literal"><span class="pre"><span class="Identifier">definition</span></span></tt> and the other is <tt class="docutils literal"><span class="pre"><span class="Identifier">usage</span></span></tt>. A <tt class="docutils literal"><span class="pre"><span class="Identifier">definition</span></span></tt> are any position where the grammar construct is intended to introduce a new symbol, i.e.: the name of a routine, including its parameters; names of variables (<tt class="docutils literal"><span class="pre"><span class="Keyword">const</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Keyword">let</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Keyword">var</span></span></tt>), and so on. All other sites are <tt class="docutils literal"><span class="pre"><span class="Identifier">usage</span></span></tt> sites, where a symbol of &quot;chunk&quot; of AST might be used.</p>
<p>This is a draft of subsitution rules:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> template bodies accept <tt class="docutils literal"><span class="pre"><span class="Identifier">typed</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> params in definition or usage positions; and all other params are usage only</li>
<li><dl class="docutils"><dt><tt class="docutils literal"><span class="pre"><span class="Identifier">typed</span></span></tt> template bodies accept <tt class="docutils literal"><span class="pre"><span class="Identifier">typed</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Identifier">untyped</span></span></tt> params in definition</dt>
<dd>or usage positions; and all other params are usage only</dd>
</dl>
</li>
<li>non-ast template bodies only allow subsitutions within usage positions</li>
</ul>
<p>This implements the first pass over the generic body; it resolves some symbols. Thus for generics there is a two-phase symbol lookup.</p>
<p>A two-phase lookup as today is templates and not generics, AKA mistake.</p>
<p>A problem is that it cannot be detected if the symbol is introduced as in <tt class="docutils literal"><span class="pre">var x = ...</span></tt> or used because macros/templates can hide this! So we have to eval templates/macros right here so that symbol lookup can be accurate.</p>
included from sem.nim<dl class="docutils"><dt>this module does the semantic checking of statements</dt>
<dd>included from sem.nim</dd>
</dl>
<dl class="docutils"><dt>This module does the semantic transformation of the fields* iterators.</dt>
<dd>included from semstmts.nim</dd>
</dl>
this module does the semantic checking for expressions included from sem.nimThis module implements Nim's object construction rules.
<h1><a class="toc-backref" id="future-considerationsslashimprovementscolon" href="#future-considerationsslashimprovementscolon">Future Considerations/Improvements:</a></h1><ul class="simple"><li>The return nil pattern leads to a lot of boilerplate, most of this is for <tt class="docutils literal"><span class="pre"><span class="Identifier">PNode</span></span></tt>s which can be converted to use nkEmpty and/or optional.</li>
</ul>
included from sem.nim</p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="../ast/ast.html">../ast/ast</a>, <a class="reference external" href="../ast/astalgo.html">../ast/astalgo</a>, <a class="reference external" href="../ast/checked_ast.html">../ast/checked_ast</a>, <a class="reference external" href="../ast/trees.html">../ast/trees</a>, <a class="reference external" href="../ast/wordrecg.html">../ast/wordrecg</a>, <a class="reference external" href="../ast/renderer.html">../ast/renderer</a>, <a class="reference external" href="../ast/types.html">../ast/types</a>, <a class="reference external" href="../ast/nimsets.html">../ast/nimsets</a>, <a class="reference external" href="../ast/errorreporting.html">../ast/errorreporting</a>, <a class="reference external" href="../ast/errorhandling.html">../ast/errorhandling</a>, <a class="reference external" href="../ast/astmsgs.html">../ast/astmsgs</a>, <a class="reference external" href="../ast/lineinfos.html">../ast/lineinfos</a>, <a class="reference external" href="../ast/idents.html">../ast/idents</a>, <a class="reference external" href="../ast/enumtostr.html">../ast/enumtostr</a>, <a class="reference external" href="../ast/linter.html">../ast/linter</a>, <a class="reference external" href="../modules/magicsys.html">../modules/magicsys</a>, <a class="reference external" href="../modules/modulepaths.html">../modules/modulepaths</a>, <a class="reference external" href="../modules/importer.html">../modules/importer</a>, <a class="reference external" href="../modules/modulegraphs.html">../modules/modulegraphs</a>, <a class="reference external" href="../front/options.html">../front/options</a>, <a class="reference external" href="../front/msgs.html">../front/msgs</a>, <a class="reference external" href="../utils/ropes.html">../utils/ropes</a>, <a class="reference external" href="../utils/platform.html">../utils/platform</a>, <a class="reference external" href="../utils/nversion.html">../utils/nversion</a>, <a class="reference external" href="../utils/debugutils.html">../utils/debugutils</a>, <a class="reference external" href="../utils/int128.html">../utils/int128</a>, <a class="reference external" href="../utils/astrepr.html">../utils/astrepr</a>, <a class="reference external" href="../utils/idioms.html">../utils/idioms</a>, <a class="reference external" href="semfold.html">semfold</a>, <a class="reference external" href="typeallowed.html">typeallowed</a>, <a class="reference external" href="isolation_check.html">isolation_check</a>, <a class="reference external" href="procfind.html">procfind</a>, <a class="reference external" href="lookups.html">lookups</a>, <a class="reference external" href="pragmas.html">pragmas</a>, <a class="reference external" href="passes.html">passes</a>, <a class="reference external" href="semdata.html">semdata</a>, <a class="reference external" href="semtypinst.html">semtypinst</a>, <a class="reference external" href="sigmatch.html">sigmatch</a>, <a class="reference external" href="transf.html">transf</a>, <a class="reference external" href="aliases.html">aliases</a>, <a class="reference external" href="sempass2.html">sempass2</a>, <a class="reference external" href="patterns.html">patterns</a>, <a class="reference external" href="parampatterns.html">parampatterns</a>, <a class="reference external" href="evaltempl.html">evaltempl</a>, <a class="reference external" href="lowerings.html">lowerings</a>, <a class="reference external" href="../backend/cgmeth.html">../backend/cgmeth</a>, <a class="reference external" href="../plugins/active.html">../plugins/active</a>, <a class="reference external" href="../vm/compilerbridge.html">../vm/compilerbridge</a>, <a class="reference external" href="../vm/vmdef.html">../vm/vmdef</a>, <a class="reference external" href="../ast/reports_sem.html">../ast/reports_sem</a>, <a class="reference external" href="../ast/reports_vm.html">../ast/reports_vm</a>, <a class="reference external" href="../ast/report_enums.html">../ast/report_enums</a>, <a class="reference external" href="../tools/suggest.html">../tools/suggest</a>, <a class="reference external" href="../ast/typesrenderer.html">../ast/typesrenderer</a>, <a class="reference external" href="../front/optionsprocessor.html">../front/optionsprocessor</a>
</dl></div>
<div class="section" id="10">
<h1><a class="toc-backref" href="#10">Consts</a></h1>
<dl class="item">
<div id="semPass">
<dt><pre><a href="sem.html#semPass"><span class="Identifier">semPass</span></a> <span class="Other">=</span> <span class="Other">(</span><span class="Identifier">open</span><span class="Other">:</span> <span class="Identifier">myOpen</span><span class="Other">,</span> <span class="Identifier">process</span><span class="Other">:</span> <span class="Identifier">myProcess</span><span class="Other">,</span> <span class="Identifier">close</span><span class="Other">:</span> <span class="Identifier">myClose</span><span class="Other">,</span> <span class="Identifier">isFrontend</span><span class="Other">:</span> <span class="DecNumber">true</span><span class="Other">)</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L993"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L993" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="tyGenericLike">
<dt><pre><a href="sem.html#tyGenericLike"><span class="Identifier">tyGenericLike</span></a> <span class="Other">=</span> <span class="Other">{</span><span class="DecNumber">tyGenericInvocation</span><span class="Other">,</span> <span class="DecNumber">tyGenericInst</span><span class="Other">,</span> <span class="DecNumber">tyArray</span><span class="Other">,</span> <span class="DecNumber">tySet</span><span class="Other">,</span> <span class="DecNumber">tySequence</span><span class="Other">,</span>
                 <span class="DecNumber">tyOpenArray</span><span class="Other">,</span> <span class="DecNumber">tyUserTypeClassInst</span><span class="Other">..</span><span class="DecNumber">tyCompositeTypeClass</span><span class="Other">}</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semmagic.nim#L138"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semmagic.nim#L138" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="tyMagicGenerics">
<dt><pre><a href="sem.html#tyMagicGenerics"><span class="Identifier">tyMagicGenerics</span></a> <span class="Other">=</span> <span class="Other">{</span><span class="DecNumber">tySet</span><span class="Other">,</span> <span class="DecNumber">tySequence</span><span class="Other">,</span> <span class="DecNumber">tyArray</span><span class="Other">,</span> <span class="DecNumber">tyOpenArray</span><span class="Other">}</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semmagic.nim#L136"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semmagic.nim#L136" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="tyUserDefinedGenerics">
<dt><pre><a href="sem.html#tyUserDefinedGenerics"><span class="Identifier">tyUserDefinedGenerics</span></a> <span class="Other">=</span> <span class="Other">{</span><span class="DecNumber">tyGenericInst</span><span class="Other">,</span> <span class="DecNumber">tyGenericInvocation</span><span class="Other">,</span> <span class="DecNumber">tyUserTypeClassInst</span><span class="Other">}</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semmagic.nim#L133"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semmagic.nim#L133" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<div id="commonType,PContext,PType,PType">
<dt><pre><span class="Keyword">proc</span> <a href="#commonType%2CPContext%2CPType%2CPType"><span class="Identifier">commonType</span></a><span class="Other">(</span><span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">,</span> <span class="Identifier">y</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a><span class="Other">)</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ReadDirEffect</span><span class="Other">,</span> <span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L269"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L269" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="commonType,PContext,PType,PNode">
<dt><pre><span class="Keyword">proc</span> <a href="#commonType%2CPContext%2CPType%2CPNode"><span class="Identifier">commonType</span></a><span class="Other">(</span><span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a><span class="Other">;</span> <span class="Identifier">y</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">)</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ReadDirEffect</span><span class="Other">,</span> <span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L358"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L358" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="defNameErrorNodeAllowsSymUpdate,PNode">
<dt><pre><span class="Keyword">func</span> <a href="#defNameErrorNodeAllowsSymUpdate%2CPNode"><span class="Identifier">defNameErrorNodeAllowsSymUpdate</span></a><span class="Other">(</span><span class="Identifier">n</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

true if <tt class="docutils literal"><span class="pre"><span class="Identifier">n</span></span></tt> is an <tt class="docutils literal"><span class="pre"><span class="Identifier">nkError</span></span></tt> of kind <tt class="docutils literal"><span class="pre"><span class="Identifier">adSemSymNameSym</span></span></tt> and the error is minor enough to allow the recovery sym to be updated. Used to see if progress is allowed inspite of errors.
&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L373"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L373" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="getDefNameSymOrRecover,PNode">
<dt><pre><span class="Keyword">func</span> <a href="#getDefNameSymOrRecover%2CPNode"><span class="Identifier">getDefNameSymOrRecover</span></a><span class="Other">(</span><span class="Identifier">n</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">)</span><span class="Other">:</span> <a href="../ast/ast_types.html#PSym"><span class="Identifier">PSym</span></a> {.<span class="Identifier">inline</span><span class="Other">,</span> <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

extracts the symbol from <tt class="docutils literal"><span class="pre"><span class="Identifier">n</span></span></tt>, which must be an <tt class="docutils literal"><span class="pre"><span class="Identifier">nkSym</span></span></tt> or <tt class="docutils literal"><span class="pre"><span class="Identifier">nkError</span></span></tt> with diagnostic kind of <tt class="docutils literal"><span class="pre"><span class="Identifier">adSemDefNameSym</span></span></tt>. If <tt class="docutils literal"><span class="pre"><span class="Identifier">n</span></span></tt> is an error, a recovery symbol is extracted, allowing progress to be made.
&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L380"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L380" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="instGenericConvertersArg,PContext,PNode,TCandidate">
<dt><pre><span class="Keyword">proc</span> <a href="#instGenericConvertersArg%2CPContext%2CPNode%2CTCandidate"><span class="Identifier">instGenericConvertersArg</span></a><span class="Other">(</span><span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">;</span> <span class="Identifier">a</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <a href="sigmatch.html#TCandidate"><span class="Identifier">TCandidate</span></a><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">ERecoverableError</span><span class="Other">,</span> <span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">ValueError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">,</span> <span class="Identifier">ReadDirEffect</span><span class="Other">,</span> <span class="Identifier">ReadIOEffect</span><span class="Other">,</span> <span class="Identifier">ReadEnvEffect</span><span class="Other">,</span> <span class="Identifier">TimeEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semcall.nim#L403"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semcall.nim#L403" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="instGenericConvertersSons,PContext,PNode,TCandidate">
<dt><pre><span class="Keyword">proc</span> <a href="#instGenericConvertersSons%2CPContext%2CPNode%2CTCandidate"><span class="Identifier">instGenericConvertersSons</span></a><span class="Other">(</span><span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">;</span> <span class="Identifier">n</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">;</span> <span class="Identifier">x</span><span class="Other">:</span> <a href="sigmatch.html#TCandidate"><span class="Identifier">TCandidate</span></a><span class="Other">)</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">ERecoverableError</span><span class="Other">,</span> <span class="Identifier">KeyError</span><span class="Other">,</span> <span class="Identifier">ValueError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">,</span> <span class="Identifier">ReadDirEffect</span><span class="Other">,</span> <span class="Identifier">ReadIOEffect</span><span class="Other">,</span> <span class="Identifier">ReadEnvEffect</span><span class="Other">,</span> <span class="Identifier">TimeEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semcall.nim#L413"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semcall.nim#L413" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="maybeResemArgs,PContext,PNode,int">
<dt><pre><span class="Keyword">proc</span> <a href="#maybeResemArgs%2CPContext%2CPNode%2Cint"><span class="Identifier">maybeResemArgs</span></a><span class="Other">(</span><span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">;</span> <span class="Identifier">n</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">;</span> <span class="Identifier">startIdx</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">]</span> {.
    <span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semcall.nim#L93"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semcall.nim#L93" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="newSymGNode,TSymKind,PNode,PContext">
<dt><pre><span class="Keyword">proc</span> <a href="#newSymGNode%2CTSymKind%2CPNode%2CPContext"><span class="Identifier">newSymGNode</span></a><span class="Other">(</span><span class="Identifier">kind</span><span class="Other">:</span> <a href="../ast/ast_types.html#TSymKind"><span class="Identifier">TSymKind</span></a><span class="Other">;</span> <span class="Identifier">n</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">;</span> <span class="Identifier">c</span><span class="Other">:</span> <a href="semdata.html#PContext"><span class="Identifier">PContext</span></a><span class="Other">)</span><span class="Other">:</span> <a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>

<p>like newSymS, but considers gensym'ed symbols, analyses <tt class="docutils literal"><span class="pre"><span class="Identifier">n</span></span></tt> producing a canonical symbol node (<tt class="docutils literal"><span class="pre"><span class="Identifier">nkSym</span></span></tt>), or if unsuccessful an <tt class="docutils literal"><span class="pre"><span class="Identifier">nkError</span></span></tt> with an <tt class="docutils literal"><span class="pre"><span class="Identifier">adSemDefNameSym</span></span></tt> diagnostic.</p>
<p>Symbol canonicalization is is as follows:</p>
<ol class="simple"><li><dl class="docutils"><dt><tt class="docutils literal"><span class="pre"><span class="Identifier">nkSym</span></span></tt> -&gt; match <tt class="docutils literal"><span class="pre"><span class="Identifier">kind</span></span></tt> (or <tt class="docutils literal"><span class="pre"><span class="Identifier">skTemp</span></span></tt>) and updates the sym owner to the</dt>
<dd>current context (gensym specific)</dd>
</dl>
</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">nkIdentKinds</span></span></tt> -&gt; instantiate a symbol considering quoted identifiers</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">nkError</span></span></tt> -&gt; simply returns the same error</li>
<li>other kinds -&gt; new error</li>
</ol>

&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L393"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L393" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>
<div id="toLiterals,IntSet,PType">
<dt><pre><span class="Keyword">proc</span> <a href="#toLiterals%2CIntSet%2CPType"><span class="Identifier">toLiterals</span></a><span class="Other">(</span><span class="Identifier">vals</span><span class="Other">:</span> <span class="Identifier">IntSet</span><span class="Other">;</span> <span class="Identifier">t</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">seq</span><span class="Other">[</span><a href="../ast/ast_types.html#PNode"><span class="Identifier">PNode</span></a><span class="Other">]</span> {.<span><span class="Other pragmadots">...</span></span><span class="pragmawrap"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span>.}</pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/semtypes.nim#L739"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/semtypes.nim#L739" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>
<div class="section" id="18">
<h1><a class="toc-backref" href="#18">Templates</a></h1>
<dl class="item">
<div id="commonTypeBegin.t">
<dt><pre><span class="Keyword">template</span> <a href="#commonTypeBegin.t"><span class="Identifier">commonTypeBegin</span></a><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <a href="../ast/ast_types.html#PType"><span class="Identifier">PType</span></a></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-works/nimskull/tree/def4e6559b395a10c1d5980be28474ded860e80f/compiler/sem/sem.nim#L267"
class="link-seesrc" target="_blank">Source</a>
&nbsp;&nbsp;<a href="https://github.com/nim-works/nimskull/edit/devel/compiler/sem/sem.nim#L267" class="link-seesrc" target="_blank" >Edit</a>

</dd>
</div>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2023-06-07 00:00:00 UTC</small>
      </div>
    </div>
  </div>
</div>
</body>
</html>
