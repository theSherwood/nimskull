<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>NimScript</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  if (toggleSwitch !== null) {
    toggleSwitch.addEventListener('change', switchTheme, false);
  }

  var currentTheme = localStorage.getItem('theme');
  if (!currentTheme && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    currentTheme = 'dark';
  }
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark' && toggleSwitch !== null) {
      toggleSwitch.checked = true;
    }
  }
}

window.addEventListener('DOMContentLoaded', main);
</script>

</head>
<body>
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">NimScript</h1>
    <p>Strictly speaking, <tt class="docutils literal"><span class="pre"><span class="Identifier">NimScript</span></span></tt> is the subset of Nim that can be evaluated by Nim's builtin virtual machine (VM). This VM is used for Nim's compiletime function evaluation features.</p>

<h1 id="intro-to-scripting">Intro to Scripting</h1><p>NimScript can be used directly as a portable replacement for Bash and Batch files. Use <tt class="docutils literal"><span class="pre"><span class="program">nim</span> <span class="Identifier">myscript.nims</span></span></tt> to run <tt class="docutils literal"><span class="pre">myscript.nims</span></tt>. For example, installation of a program could be accomplished with this simple script:</p>
<pre class="listing"><span class="Identifier">mode</span> <span class="Operator">=</span> <span class="Identifier">ScriptMode</span><span class="Operator">.</span><span class="Identifier">Verbose</span>

<span class="Keyword">var</span> <span class="Identifier">id</span> <span class="Operator">=</span> <span class="DecNumber">0</span>
<span class="Keyword">while</span> <span class="Identifier">dirExists</span><span class="Punctuation">(</span><span class="StringLit">&quot;foo&quot;</span> <span class="Operator">&amp;</span> <span class="Operator">$</span><span class="Identifier">id</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">inc</span> <span class="Identifier">id</span>

<span class="Identifier">exec</span> <span class="StringLit">&quot;git clone https://github.com/bar/foo.git&quot;</span> <span class="Operator">&amp;</span> <span class="Operator">$</span><span class="Identifier">id</span>

<span class="Identifier">withDir</span> <span class="StringLit">&quot;foo&quot;</span> <span class="Operator">&amp;</span> <span class="Operator">$</span><span class="Identifier">id</span> <span class="Operator">&amp;</span> <span class="StringLit">&quot;/src&quot;</span><span class="Punctuation">:</span>
  <span class="Identifier">exec</span> <span class="StringLit">&quot;nim c foo&quot;</span>

<span class="Identifier">mvFile</span> <span class="StringLit">&quot;foo&quot;</span> <span class="Operator">&amp;</span> <span class="Operator">$</span><span class="Identifier">id</span> <span class="Operator">&amp;</span> <span class="StringLit">&quot;/src/foo&quot;</span><span class="Operator">.</span><span class="Identifier">toExe</span><span class="Punctuation">,</span> <span class="StringLit">&quot;bin/foo&quot;</span><span class="Operator">.</span><span class="Identifier">toExe</span></pre><p>On Unix, you can also use the shebang <tt class="docutils literal"><span class="pre"><span class="Comment">#!/usr/bin/env nim</span></span></tt>, as long as your filename ends with <tt class="docutils literal"><span class="pre">.nims</span></tt>:</p>
<pre class="listing"><span class="Comment">#!/usr/bin/env nim</span>
<span class="Identifier">mode</span> <span class="Operator">=</span> <span class="Identifier">ScriptMode</span><span class="Operator">.</span><span class="Identifier">Silent</span>

<span class="Identifier">echo</span> <span class="StringLit">&quot;hello world&quot;</span></pre><p>Use <tt class="docutils literal"><span class="pre"><span class="Comment">#!/usr/bin/env -S nim --hints:off</span></span></tt> to disable hints.</p>

<h1 id="dryminusrun-and-debugging">Dry-Run and Debugging</h1><p>Defining <tt class="docutils literal"><span class="pre"><span class="Identifier">scriptmode</span></span></tt> on the command-line like so: <tt class="docutils literal"><span class="pre"><span class="program">nim</span> <span class="option">-d:scriptmode</span> <span class="Identifier">foo.nims</span></span></tt> ensures that it's run in <tt class="docutils literal"><span class="pre"><span class="Identifier">WhatIf</span></span></tt> mode, where effects such as shell execution, file IO, and so on are logged to the console and never ran. There are additional options, see <a class="reference external" href="nimscript.html">nimscript</a> for details.</p>

<h1 id="extensions-amp-limitations">Extensions &amp; Limitations</h1><p>Since the VM is limited in what it can do for security reasons, a set of procs allowing for file IO, shell execution, and so on are availabe in the <a class="reference external" href="nimscript.html">nimscript</a> module. There is also support for some OS native package managers in the <a class="reference external" href="distros.html">distros</a> module.</p>
<p>NimScript is subject to some limitations caused by the implementation of the VM (virtual machine):</p>
<ul class="simple"><li>Nim's FFI (foreign function interface) is not available in NimScript. This means that any stdlib module which relies on <tt class="docutils literal"><span class="pre"><span class="Identifier">importc</span></span></tt> can not be used in the VM.</li>
<li><tt class="docutils literal"><span class="pre"><span class="Keyword">ptr</span></span></tt> operations are are hard to emulate with the symbolic representation the VM uses. They are available and tested extensively but there are bugs left.</li>
<li><tt class="docutils literal"><span class="pre"><span class="Keyword">var</span> <span class="Identifier">T</span></span></tt> function arguments rely on <tt class="docutils literal"><span class="pre"><span class="Keyword">ptr</span></span></tt> operations internally and might also be problematic in some cases.</li>
<li>More than one level of <tt class="docutils literal"><span class="pre"><span class="Keyword">ref</span></span></tt> is generally not supported (for example, the type <tt class="docutils literal"><span class="pre"><span class="Keyword">ref</span> <span class="Keyword">ref</span> <span class="Identifier">int</span></span></tt>).</li>
<li>Multimethods are not available.</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">random</span><span class="Operator">.</span><span class="Identifier">randomize</span><span class="Punctuation">(</span><span class="Punctuation">)</span></span></tt> requires an <tt class="docutils literal"><span class="pre"><span class="Identifier">int64</span></span></tt> explicitly passed as argument, you <em>must</em> pass a Seed integer.</li>
</ul>

<h1 id="standard-library-modules">Standard library modules</h1><p>At least the following standard library modules are available:</p>
<ul class="simple"><li><a class="reference external" href="macros.html">macros</a></li>
<li><a class="reference external" href="os.html">os</a></li>
<li><a class="reference external" href="strutils.html">strutils</a></li>
<li><a class="reference external" href="math.html">math</a></li>
<li><a class="reference external" href="distros.html">distros</a></li>
<li><a class="reference external" href="sugar.html">sugar</a></li>
<li><a class="reference external" href="algorithm.html">algorithm</a></li>
<li><a class="reference external" href="base64.html">base64</a></li>
<li><a class="reference external" href="bitops.html">bitops</a></li>
<li><a class="reference external" href="colors.html">colors</a></li>
<li><a class="reference external" href="complex.html">complex</a></li>
<li><a class="reference external" href="htmlgen.html">htmlgen</a></li>
<li><a class="reference external" href="httpcore.html">httpcore</a></li>
<li><a class="reference external" href="lenientops.html">lenientops</a></li>
<li><a class="reference external" href="mersenne.html">mersenne</a></li>
<li><a class="reference external" href="options.html">options</a></li>
<li><a class="reference external" href="parseutils.html">parseutils</a></li>
<li><a class="reference external" href="punycode.html">punycode</a></li>
<li><a class="reference external" href="punycode.html">random</a></li>
<li><a class="reference external" href="stats.html">stats</a></li>
<li><a class="reference external" href="strformat.html">strformat</a></li>
<li><a class="reference external" href="strmisc.html">strmisc</a></li>
<li><a class="reference external" href="strscans.html">strscans</a></li>
<li><a class="reference external" href="unicode.html">unicode</a></li>
<li><a class="reference external" href="uri.html">uri</a></li>
<li><a class="reference external" href="editdistance.html">std/editdistance</a></li>
<li><a class="reference external" href="wordwrap.html">std/wordwrap</a></li>
<li><a class="reference external" href="sums.html">std/sums</a></li>
<li><a class="reference external" href="parsecsv.html">parsecsv</a></li>
<li><a class="reference external" href="parsecfg.html">parsecfg</a></li>
<li><a class="reference external" href="parsesql.html">parsesql</a></li>
<li><a class="reference external" href="xmlparser.html">xmlparser</a></li>
<li><a class="reference external" href="htmlparser.html">htmlparser</a></li>
<li><a class="reference external" href="ropes.html">ropes</a></li>
<li><a class="reference external" href="json.html">json</a></li>
<li><a class="reference external" href="parsejson.html">parsejson</a></li>
<li><a class="reference external" href="strtabs.html">strtabs</a></li>
<li><a class="reference external" href="unidecode.html">unidecode</a></li>
</ul>
<p>In addition to the standard Nim syntax (<a class="reference external" href="system.html">system</a> module), NimScripts support the procs and templates defined in the <a class="reference external" href="nimscript.html">nimscript</a> module too.</p>
<p>See also:</p>
<ul class="simple"><li><a class="reference external" href="https://github.com/nim-works/nimskull/blob/devel/tests/test_nimscript.nims">Check the tests for more information about modules compatible with NimScript.</a></li>
</ul>

<h1 id="benefits">Benefits</h1>
<h2 id="crossminusplatform">Cross-Platform</h2><p>It is a cross-platform scripting language that can run where  NimSkull can run, e.g. you can not run Batch or PowerShell on Linux or Mac, the Bash for Linux might not run on Mac, there are no unit tests tools for Batch, etc.</p>
<p>NimScript can detect on which platform, operating system, architecture, and even which Linux distribution is running on, allowing the same script to support a lot of systems.</p>
<p>See the following (incomplete) example:</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">std</span><span class="Operator">/</span><span class="Identifier">distros</span>

<span class="Comment"># Architectures.</span>
<span class="Keyword">if</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">amd64</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Architecture is x86 64Bits&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">i386</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Architecture is x86 32Bits&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">arm</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Architecture is ARM&quot;</span>

<span class="Comment"># Operating Systems.</span>
<span class="Keyword">if</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">linux</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Operating System is GNU Linux&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">windows</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Operating System is Microsoft Windows&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">defined</span><span class="Punctuation">(</span><span class="Identifier">macosx</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Operating System is Apple OS X&quot;</span>

<span class="Comment"># Distros.</span>
<span class="Keyword">if</span> <span class="Identifier">detectOs</span><span class="Punctuation">(</span><span class="Identifier">Ubuntu</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Distro is Ubuntu&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">detectOs</span><span class="Punctuation">(</span><span class="Identifier">ArchLinux</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Distro is ArchLinux&quot;</span>
<span class="Keyword">elif</span> <span class="Identifier">detectOs</span><span class="Punctuation">(</span><span class="Identifier">Debian</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="StringLit">&quot;Distro is Debian&quot;</span></pre>
<h2 id="uniform-syntax">Uniform Syntax</h2><p>The syntax, style, and rest of the ecosystem is the same as for compiled Nim, that means there is nothing new to learn, no context switch for developers.</p>

<h2 id="powerful-metaprogramming">Powerful Metaprogramming</h2><p>NimScript can use Nim's templates, macros, types, concepts, effect tracking system, and more, you can create modules that work in both a compiled or scripting context.</p>
<p><tt class="docutils literal"><span class="pre"><span class="Keyword">func</span></span></tt> will still check for side effects, <tt class="docutils literal"><span class="pre"><span class="Identifier">debugEcho</span></span></tt> also works as expected, making it ideal for functional scripting metaprogramming.</p>
<p>This is an example of a third party module that uses macros and templates to translate text strings on unmodified NimScript:</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">nimterlingua</span>
<span class="Identifier">nimterlingua</span><span class="Punctuation">(</span><span class="StringLit">&quot;translations.cfg&quot;</span><span class="Punctuation">)</span>
<span class="Identifier">echo</span> <span class="StringLit">&quot;cat&quot;</span>  <span class="Comment"># Run with -d:RU becomes &quot;kot&quot;, -d:ES becomes &quot;gato&quot;, ...</span></pre><p>translations.cfg</p>
<pre class="listing">[cat]
ES = gato
IT = gatto
RU = kot
FR = chat</pre>
<h2 id="graceful-fallback">Graceful Fallback</h2><p>Some features of compiled  NimSkull may not work on NimScript, but often a graceful and seamless fallback degradation is used.</p>
<p>See the following NimScript:</p>
<pre class="listing"><span class="Keyword">if</span> <span class="Identifier">likely</span><span class="Punctuation">(</span><span class="Identifier">true</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Keyword">discard</span>
<span class="Keyword">elif</span> <span class="Identifier">unlikely</span><span class="Punctuation">(</span><span class="Identifier">false</span><span class="Punctuation">)</span><span class="Punctuation">:</span>
  <span class="Keyword">discard</span>

<span class="Keyword">proc</span> <span class="Identifier">foo</span><span class="Punctuation">(</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">compiletime</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span> <span class="Identifier">echo</span> <span class="Identifier">NimVersion</span>

<span class="Keyword">static</span><span class="Punctuation">:</span>
  <span class="Identifier">echo</span> <span class="Identifier">CompileDate</span></pre><p><tt class="docutils literal"><span class="pre"><span class="Identifier">likely</span><span class="Punctuation">(</span><span class="Punctuation">)</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">unlikely</span><span class="Punctuation">(</span><span class="Punctuation">)</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Keyword">static</span><span class="Punctuation">:</span></span></tt> and <tt class="docutils literal"><span class="pre"><span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">compiletime</span><span class="Operator">.</span><span class="Punctuation">}</span></span></tt> will produce no code at all when run on NimScript, but still no error nor warning is produced and the code just works.</p>

<h2 id="evolving-scripting-language">Evolving Scripting language</h2><p>NimScript evolves together with  NimSkull, <a class="reference external" href="https://github.com/nim-lang/Nim/pulls?utf8=%E2%9C%93&amp;q=nimscript">occasionally new features might become available on NimScript</a> , adapted from compiled  NimSkull or added as new features on both.</p>

<h2 id="devops-scripting">DevOps Scripting</h2><p>You can use NimScript to deploy to production, run tests, build projects, do benchmarks, generate documentation, and all kinds of DevOps/SysAdmin specific tasks. </p>



    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2023-07-12 00:00:00 UTC</small>
      </div>
    </div>
  </div>
</div>
</body>
</html>
